<template>
    <lightning-card>
            <template for:each={productsMapByCategory} for:item="category">
                <lightning-accordion key={category.key} allow-multiple-sections-open>
                        <lightning-accordion-section name={category.key} label={category.key}>
                            <lightning-datatable 
                                key-field="Id"
                                data={category.value}
                                hide-checkbox-column
                                column-widths-mode="auto"
                                columns={columns}
                                onrowaction={handleRowAction}
                            >
                            </lightning-datatable>
                        </lightning-accordion-section> 
                </lightning-accordion>
            </template>


            <template if:true={showModalPopup}>
                <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-01" class="slds-modal slds-fade-in-open slds-modal_medium">
                    <div class="slds-modal__container">
                        <button class="slds-button slds-button_icon slds-modal__close" onclick={handleClose}>
                            <lightning-icon icon-name="utility:close" size="small"></lightning-icon>

                            <span class="slds-assistive-text">Cancel and close</span>
                        </button>
                        <div class="slds-modal__header">
                            <h1 id="modal-heading-01" class="slds-modal__title slds-hyphenate" tabindex="-1">Modal header</h1>
                        </div>
                        <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                            <lightning-record-edit-form record-id={recordId} object-api-name={objectApiName} onsuccess={handleSuccess}>
                                <lightning-input-field field-name="FirstName"></lightning-input-field> 
                                <lightning-input-field field-name="LastName"></lightning-input-field> 
                                <lightning-input-field field-name="Email"></lightning-input-field> 

                                <div class="slds-modal__footer">
                                    <button class="slds-button slds-button_neutral" aria-label="Cancel and close">Cancel</button>
                                    <button class="slds-button slds-button_brand">Save</button>
                                </div>
                            </lightning-record-edit-form>

                        </div>
                    </div>
            
                </section>
                <div class="slds-backdrop slds-backdrop_open" role="presentation"></div>
            </template>
            
        
        <template if:true={errors}>
            <p> {errors} </p>
        </template>
    </lightning-card>
</template>